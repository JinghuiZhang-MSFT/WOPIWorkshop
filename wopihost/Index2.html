<!doctype html>
<html>
<head>
    <meta charset="utf-8">

    <!-- Enable IE Standards mode -->
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title></title>
    <meta name="description" content="">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">

    <link rel="shortcut icon"
          href="<OFFICE ONLINE APPLICATION FAVICON URL>" />

    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
            overflow:hidden;
            -ms-content-zooming: none;
        }

        #office_frame {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            margin: 0;
            border: none;
            display: block;
        }
    </style>
</head>
<body>
    <form id="office_form" name="office_form" target="office_frame"
          action="" method="post">
        <!--<input name="access_token" value="<ACCESS_TOKEN_VALUE>" type="hidden" />-->
        <!--<input name="access_token_ttl" value="<ACCESS_TOKEN_TTL_VALUE>" type="hidden" />-->
    </form>

    <div class="container">
        <div class="row">
            <h1>Sample Host Page</h1>
        </div>
        <div class="row">
            <div class="col-md-1">
                <div class="list-group" id="fileList" name="fileList">
                    <label type="label" class="list-group-item">MS-WOPI.docx</label>
                    <button type="button" class="list-group-item" onclick="openFile('test1.docx')">View</button>
                    <button type="button" class="list-group-item" onclick="editFile('test1.docx')">Edit</button>
                    <br/>
                    <label type="label" class="list-group-item">Test.xlsx</label>
                    <button type="button" class="list-group-item" onclick="openFile('test1.xlsx')">View</button>
                    <button type="button" class="list-group-item" onclick="editFile('test1.xlsx')">Edit</button>
                    <br />
                </div>
            </div>
            <div class="col-md-1">
                <span id="frameholder">
                    <iframe name="office_frame" id="office_frame" style="position:relative;height:800px"></iframe>
                </span>
            </div>
        </div>
    </div>

<script type="text/javascript">

    function Display(url) {
        //var frameholder = document.getElementById('frameholder');
        //var office_frame = document.createElement('iframe');
        //office_frame.name = 'office_frame';
        //office_frame.id = 'office_frame';

        //// The title should be set for accessibility
        //office_frame.title = 'Office Online Frame';

        //// This attribute allows true fullscreen mode in slideshow view
        //// when using PowerPoint Online's 'view' action.
        //office_frame.setAttribute('allowfullscreen', 'true');

        //frameholder.appendChild(office_frame);

        document.getElementById('office_form').action = url;
        document.getElementById('office_form').submit();
    }

    function openFile(name) {
        var fileextend = name.split('.').pop();
        var officeserver = "";
        switch (fileextend) {
            case "docx":
                officeserver = "http://jinghuiz-vm/wv/wordviewerframe.aspx?";
                break;
            case "xlsx":
                officeserver = "http://jinghuiz-vm/x/_layouts/xlviewerinternal.aspx?";
                break;
        }
        var wopiserver = "wopisrc=http://jhz-officeser/wopi/files/";
        var targetSrc = officeserver + wopiserver + name + "&access_token=fdjkal";
        Display(targetSrc);
    }

    function editFile(name) {
        var fileextend = name.split('.').pop();
        var officeserver = "";
        switch (fileextend) {
            case "docx":
                officeserver = "http://jinghuiz-vm/we/wordeditorframe.aspx?";
                break;
            case "xlsx":
                officeserver = "http://jinghuiz-vm/x/_layouts/xlviewerinternal.aspx?edit=1&";
                break;
        }
        var wopiserver = "wopisrc=http://jhz-officeser/wopi/files/";
        var targetSrc = officeserver + wopiserver + name + "&access_token=fdjkal";
        Display(targetSrc);
    }
</script>
</body>
</html>
