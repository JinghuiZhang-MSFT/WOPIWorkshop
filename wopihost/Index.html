<!doctype html>
<html>
<head>
    <meta charset="utf-8">

    <!-- Enable IE Standards mode -->
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title></title>
    <meta name="description" content="">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.12.0.min.js"></script>
    <link rel="shortcut icon"
          href="<OFFICE ONLINE APPLICATION FAVICON URL>" />

    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            -ms-content-zooming: none;
        }

        #office_frame {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            margin: 0;
            border: none;
            display: block;
        }
    </style>
</head>
<body>
    <h1>Shanghai Dev Days 2017 WOPI Workshop</h1>
    <p>
        Use this page to demo the WOPI host implementation based on:
        <a href="https://github.com/Microsoft/Office-Online-Test-Tools-and-Documentation">Office-Online-Test-Tools-and-Documentation</a>
    </p>
    <p>
        Office Server you can use: http://13.75.127.41/
        Discovery file: http://13.75.127.41/hosting/discovery
    </p>
    <button class="wopi_vw_button" id="vwDoc" onclick="buttonClick('office_form')">View Word Document</button>
    <button class="wopi_editDoc_button" id="vwDoc" onclick="buttonClick('office_editDoc_form')">Edit Word Document</button>
    <button class="wopi_vw_button" id="vwDoc" onclick="buttonClick('office_imagePreview_form')">Image Preview Word Document</button>
    <button class="wopi_vw_button" id="vwDoc" onclick="buttonClick('office_interactivepreview_form')">interactive preview Word Document</button>

    <form id="office_form" name="office_form" target="office_frame"
          action="http://jinghuiz-vm/wv/wordviewerframe.aspx?WOPISrc=http://jhz-officeser/wopi/files/test1.docx&access_token=DEADBEEFDEADBEEFDEADBEEF" method="post">
        <input name="access_token" value="DEADBEEFDEADBEEFDEADBEEF" type="hidden" />
        <input name="access_token_ttl" value="0" type="hidden" />
    </form>

    <form id="office_editDoc_form" name="office_editDoc_form" target="office_frame"
          action="http://jinghuiz-vm/we/wordeditorframe.aspx?WOPISrc=http://jhz-officeser/wopi/files/test1.docx&access_token=DEADBEEFDEADBEEFDEADBEEF" method="post">
        <input name="access_token" value="DEADBEEFDEADBEEFDEADBEEF" type="hidden" />
        <input name="access_token_ttl" value="0" type="hidden" />
    </form>

    <form id="office_imagePreview_form" name="office_imagePreview_form" target="office_frame"
          action="http://jinghuiz-vm/wv/WordPreviewHandler.ashx?WOPISrc=http://jhz-officeser/wopi/files/test1.docx&access_token=DEADBEEFDEADBEEFDEADBEEF" method="post">
        <input name="access_token" value="DEADBEEFDEADBEEFDEADBEEF" type="hidden" />
        <input name="access_token_ttl" value="0" type="hidden" />
    </form>

    <form id="office_interactivepreview_form" name="office_interactivepreview_form" target="office_frame"
          action="http://jinghuiz-vm/wv/wordviewerframe.aspx?WOPISrc=http://jhz-officeser/wopi/files/test1.docx&access_token=DEADBEEFDEADBEEFDEADBEEF" method="post">
        <input name="access_token" value="DEADBEEFDEADBEEFDEADBEEF" type="hidden" />
        <input name="access_token_ttl" value="0" type="hidden" />
    </form>

    <form id="office_imagePreview_form" name="office_imagePreview_form" target="office_frame"
          action="http://jinghuiz-vm/wv/WordPreviewHandler.ashx?WOPISrc=http://jhz-officeser/wopi/files/test1.docx&access_token=DEADBEEFDEADBEEFDEADBEEF" method="post">
        <input name="access_token" value="DEADBEEFDEADBEEFDEADBEEF" type="hidden" />
        <input name="access_token_ttl" value="0" type="hidden" />
    </form>

    <form id="office_imagePreview_form" name="office_imagePreview_form" target="office_frame"
          action="http://jinghuiz-vm/wv/WordPreviewHandler.ashx?WOPISrc=http://jhz-officeser/wopi/files/test1.docx&access_token=DEADBEEFDEADBEEFDEADBEEF" method="post">
        <input name="access_token" value="DEADBEEFDEADBEEFDEADBEEF" type="hidden" />
        <input name="access_token_ttl" value="0" type="hidden" />
    </form>

    <form id="office_imagePreview_form" name="office_imagePreview_form" target="office_frame"
          action="http://jinghuiz-vm/wv/WordPreviewHandler.ashx?WOPISrc=http://jhz-officeser/wopi/files/test1.docx&access_token=DEADBEEFDEADBEEFDEADBEEF" method="post">
        <input name="access_token" value="DEADBEEFDEADBEEFDEADBEEF" type="hidden" />
        <input name="access_token_ttl" value="0" type="hidden" />
    </form>

    <span id="frameholder"></span>

    <script type="text/javascript">
        function buttonClick(name) {
            var frameholder = document.getElementById('frameholder');
            var office_frame = document.createElement('iframe');
            office_frame.name = 'office_frame';
            office_frame.id = 'office_frame';

            // The title should be set for accessibility
            office_frame.title = 'Office Online Frame';

            // This attribute allows true fullscreen mode in slideshow view
            // when using PowerPoint Online's 'view' action.
            office_frame.setAttribute('allowfullscreen', 'false');

            frameholder.appendChild(office_frame);

            document.getElementById(name).submit();
        }
    </script>

</body>
</html>
